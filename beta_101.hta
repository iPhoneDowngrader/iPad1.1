<!DOCTYPE html>
<html style='overflow: hidden'>
<head>
	<HTA:APPLICATION ID="ksa4_gui"
        APPLICATIONNAME="KickstartA4"
        WINDOWSTATE="normal"
        MAXIMIZEBUTTON="yes"
        MINIMIZEBUTTON="yes"
        CAPTION="yes"
        SHOWINTASKBAR="yes"
    >
	<title>KickstartA4 | Hacks4live &amp; iPhoneGuy1101 | v1.01</title>
	<style>
		html {
			padding: 7.5%;
			background: #0400aa;
			color: #4944aa;
		}
		h1 {
			font: 400% Sans Serif;
			background: #020088;
			position: absolute;
			top: 7.51%;
			left: 0;
			width: 100%;
			border: solid 4px #0400AB;
		}
		div {
			background: #0600cc;
			position: absolute;
			left: 30%;
			width: 40%;
			top: 30%;
			height: 30%;
			border-radius: 10%;
			color: #6699FF;
			font-size: 225%;
		}
		select#fw {
			position: absolute;
			top: 65%;
			font-size: 150%;
			left: 20%;
			width: 60%;
			background: #07F;
			border-color: #000;
		}
		select#fw {
			position: absolute;
			top: 65%;
			font-size: 150%;
			left: 20%;
			width: 60%;
			background: #07F;
			border-color: #000;
		}
	</style>
</head>
<body style='overflow: hidden'>
	<center>
		<h1>KickstartA4</h1>
		<div id='run'><br/>Kickstart Device</div>
		
		<select id='fw'>
			<option device='iPad1,1'>iPad1,1 - iOS 3.2</option>
			<option device='iPad1,1'>iPad1,1 - iOS 4.2.1</option>
			<option>&zwj;</option>
			<option device='iPhone2,1'>iPhone2,1 - iOS 3.1.3</option>
			<option device='iPhone2,1'>iPhone2,1 - iOS 4.1</option>
			<option device='iPhone2,1'>iPhone2,1 - iOS 4.2.1</option>
			<option device='iPhone2,1'>iPhone2,1 - iOS 4.3</option>
			<option>&zwj;</option>
			<option device='iPhone3,1'>iPhone3,1 - iOS 4.0.2</option>
			<option device='iPhone3,1'>iPhone3,1 - iOS 4.1</option>
			<option device='iPhone3,1'>iPhone3,1 - iOS 4.2.1</option>
			<option device='iPhone3,1'>iPhone3,1 - iOS 4.3</option>
			<option device='iPhone3,1'>iPhone3,1 - iOS 5.1.1</option>
			<option device='iPhone3,1'>iPhone3,1 - iOS 6.1.3</option>
			<option>&zwj;</option>
			<option device='iPhone3,2'>iPhone3,2 - iOS 6.1.3</option>
			<option>&zwj;</option>
			<option device='iPhone3,3'>iPhone3,3 - iOS 4.2.6</option>
			<option device='iPhone3,3'>iPhone3,3 - iOS 4.3</option>
			<option device='iPhone3,3'>iPhone3,3 - iOS 5.1.1</option>
			<option device='iPhone3,3'>iPhone3,3 - iOS 6.1.3</option>
			<option>&zwj;</option>
			<option device='iPod3,1'>iPod3,1 - iOS 3.1.3</option>
			<option device='iPod3,1'>iPod3,1 - iOS 4.0.2</option>
			<option device='iPod3,1'>iPod3,1 - iOS 4.1</option>
			<option device='iPod3,1'>iPod3,1 - iOS 4.2.1</option>
			<option device='iPod3,1'>iPod3,1 - iOS 4.3</option>
			<option device='iPod3,1'>iPod3,1 - iOS 5.1.1</option>
			<option>&zwj;</option>
			<option device='iPod4,1'>iPod4,1 - iOS 4.1</option>
			<option device='iPod4,1'>iPod4,1 - iOS 4.2.1</option>
			<option device='iPod4,1'>iPod4,1 - iOS 4.3</option>
			<option device='iPod4,1'>iPod4,1 - iOS 5.1.1</option>
		</select>
	</center>
	<script language='javascript'>
		var wget = {
			js: "try{var WinHttpReq=new ActiveXObject(\"WinHttp.WinHttpRequest.5.1\");WinHttpReq.Open(\"GET\",WScript.Arguments(0),!1),WinHttpReq.Send(),BinStream=new ActiveXObject(\"ADODB.Stream\"),BinStream.Type=1,BinStream.Open(),BinStream.Write(WinHttpReq.ResponseBody),BinStream.SaveToFile(WScript.Arguments(1));}catch(e){}"
		};
		function getURL(DEVICEMODEL, VERSION){
		  var url = "https://raw.githubusercontent.com/LBBNetwork/opensn0w/master/bundles/DEVICEMODEL_VERSION_BUILD.plist",
		    buildids = {
		      "6.0": "10A403",
		      "5.1.1": "9B206",
		      "5.1": "9B176",
		      "5.0.1": "9A405",
		      "5.0": "9A334",
		      "4.3.5": "8L1",
		      "4.3.4": "8K2",
		      "4.3.3": "8J3",
		      "4.3.2": "8H7",
		      "4.3.1": "8G4",
		      "4.3": "8F190",
		      "4.2.1": "8C148",
		      "4.1": "8B117",
		      "4.0.2": "8A400",
		      "4.0.1": "8A306",
		      "4.0": "8A293",
		      "3.2.2": "7B500",
		      "3.2.1": "7B405",
		      "3.2": "7B367",
		      "3.1.3": "7E18",
		      "3.1.2": "7D11",
		      "3.1": "7C144",
		      "3.0.1": "7A400",
		      "3.0": "7A341"
		    };
		  function downloadIPSW(dvc, ver){
			try{
			  var WinHttpReq = new ActiveXObject("WinHttp.WinHttpRequest.5.1");
			  WinHttpReq.Open("GET", getURL(dvc, ver).url, /*async=*/false);
			  WinHttpReq.Send();
			  BinStream = new ActiveXObject("ADODB.Stream");
			  BinStream.Type = 1;
			  BinStream.Open();
			  BinStream.Write(WinHttpReq.ResponseBody);
			  var filename = dvc+"_"+ver+"_bundle.plist";
			  BinStream.SaveToFile(filename);
			} catch(e) {}
		  }
		  return {
		    url: url.replace(/DEVICEMODEL/g, DEVICEMODEL).replace(/VERSION/g, VERSION).replace(/BUILD/g, buildids[VERSION]),
		    download: function(){
		      downloadIPSW(DEVICEMODEL, VERSION);
		    },
		    filename: DEVICEMODEL+"_"+VERSION+"_bundle.plist"
		  }
		}
	function init(){
		var WshShell = new ActiveXObject("WScript.Shell");
		var commands = [
			"title KickstartA4 ^| Installing required files...",
			"cd \"%APPDATA%\"",
			"mkdir KickstartA4",
			"cd KickstartA4",
			"echo "+wget.js+" >wget.js",
			"echo Downloading components...",
			"wscript wget.js https://github.com/Devjam81/opensn0w_win/archive/master.zip opensn0w.zip",
			"wscript wget.js https://ipg1101.github.io/7za.exe 7z.exe",
			"echo Extracting components...",
			"7z x opensn0w.zip -y >nul",
			"echo Finishing up...",
			"del opensn0w.zip",
			"rename opensn0w_win-master opensn0w",
			"echo Done!"
		];
		WshShell.run("cmd /c "+commands.join(" & "));
	};
	init();
	function getBundle(){
		var v = document.getElementById('fw').options[document.getElementById('fw').selectedIndex].text.replace('iOS ','');
		// alert(v);
		if(v == '&zwj;') return v;
		v = v.split(' - ');
		var dvc = v[0];
		var ver = v[1];
		var bundle = getURL(dvc, ver);
		bundle.download();
		return bundle.filename; 
	};
	function JustBoot(){
		if(getBundle() == "&zwj;") {
			return alert("Select a device!");
		}
		var WshShell = new ActiveXObject("WScript.Shell");
		var commands = [
			"title KickstartA4 ^| Running Just Boot operation...",
			"cd \"%APPDATA%\"",
			"cd KickstartA4",
			"cd opensn0w",
			"ping localhost -n 1 >nul",
			"echo.",
			"echo Make sure your device is plugged in and in DFU mode.",
			"echo Then wait for 3 seconds...",
			"echo.",
			"opensn0w_cli -p \"%USERPROFILE%\\Desktop\\"+getBundle()+"\" >nul",
			"echo Done!",
			"pause"
		];
		WshShell.run("cmd /c "+commands.join(" & "));
	};
	document.getElementById('run').onclick = function(){
		JustBoot();
	};
	</script>
</body>
</html>
